# Environment Variable Strategy\n\nThis document outlines the strategy for managing environment variables in the bun-badges project.\nThe goal is to ensure consistency, security, and clarity across different deployment and development environments.\n\n## Core Principles\n\n1.  **Explicit Configuration:** Rely on environment variables being explicitly set for the target environment. Avoid hardcoded fallback values in the code or Docker Compose files.\n2.  **Environment-Specific Files:** Use dedicated `.env` files for specific environments (`.env.development`, `.env.test`) to manage differing configurations.\n3.  **Single Source of Truth:** For any given environment, the configuration should ideally come from a single, clear source (e.g., `.env.development` for local dev, GitHub Actions `env:` block for CI).\n4.  **Security:** Never commit sensitive credentials (`.env` files should be in `.gitignore`). Use secrets management tools for production and CI environments.\n\n## File Usage\n\n-   **`.env`:** (Optional) Can be used for shared, non-sensitive variables or as a base for local development if `.env.development` is not present. It is loaded as a fallback if no environment-specific file is loaded.\n-   **`.env.development`:** Contains variables specific to local development (`NODE_ENV=development`). This file is loaded automatically by the application (`src/index.ts`) when `NODE_ENV` is set to `development`.\n-   **`.env.test`:** Contains variables specific to the testing environment (`NODE_ENV=test`). This is loaded automatically by the application (`src/index.ts`) and test setup files (`tests/setup.ts`) when `NODE_ENV` is set to `test`.\n-   **`.env.example`:** Serves as a template, listing all required environment variables with example (non-sensitive) values. Keep this file up-to-date.\n\n## Loading Precedence\n\n1.  **System Environment Variables:** Variables set directly in the shell or by the hosting environment/CI runner typically override any values defined in `.env` files.\n2.  **Environment-Specific Files (`.env.development`, `.env.test`):** These files are loaded based on `NODE_ENV` and use `override: true` in the `dotenv` configuration, meaning they take precedence over variables defined in the base `.env` file.\n3.  **Base `.env` File:** Loaded as a fallback if no environment-specific file is loaded.\n\n## Docker Configuration\n\n-   All `docker-compose.*.yml` files have been standardized to *not* include hardcoded default values (e.g., `\${VAR:-default}`).\n-   They rely entirely on variables being present in the environment where `docker-compose` is run (which `dotenv` helps populate locally).\n-   A consistent network name (`bun-badges-network`) is used across all Docker Compose files.\n\n## CI Environment (GitHub Actions)\n\n-   The CI environment does *not* rely on loading an `.env.ci` file.\n-   Required environment variables (`NODE_ENV`, `DATABASE_URL`, `POSTGRES_USER`, etc.) are defined directly within the `.github/workflows/ci.yml` file using the `env:` block.\n-   Sensitive values (`POSTGRES_PASSWORD`, `JWT_SECRET`) are injected using GitHub Actions Secrets.\n\n## Key Variables\n\n-   `NODE_ENV`: Determines the environment (`development`, `test`, `production`). Critical for loading the correct `.env` file and conditional logic (e.g., enabling Swagger UI).\n-   `PORT`: The port the application server should listen on.\n-   `DATABASE_URL`: The full connection string for the PostgreSQL database.\n-   `JWT_SECRET`: The secret key used for signing and verifying JWTs.\n-   `POSTGRES_DB`, `POSTGRES_USER`, `POSTGRES_PASSWORD`, `DB_PORT`: Used by Docker Compose to configure the PostgreSQL container service.\n-   `PGADMIN_DEFAULT_EMAIL`, `PGADMIN_DEFAULT_PASSWORD`, `PGADMIN_PORT`: Used by Docker Compose to configure the pgAdmin service.\n\n*Note: Ensure `.env.example` is kept current with all necessary variables.* 